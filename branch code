updated code in shivakumar branch
